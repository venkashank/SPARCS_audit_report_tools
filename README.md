# SPARCS Report Processing Tools

This project provides a suite of Python scripts designed to download and process various System for Patient Access, Reporting, and Inquiry System (SPARCS) reports from the New York State Department of Health website.

## Scripts Overview

The `src/` directory contains the following scripts:

1.  **`src/compliance_report_puller.py`**
    *   **Functionality:** Downloads PDF files of SPARCS *compliance reports*.
    *   **Source URL:** [https://www.health.ny.gov/statistics/sparcs/reports/compliance/pfi_facilities.htm](https://www.health.ny.gov/statistics/sparcs/reports/compliance/pfi_facilities.htm)
    *   **Output:** Saves the downloaded PDF files into the `pdfs/` directory.

2.  **`src/compliance_table_extractor.py`**
    *   **Functionality:** Processes the PDF compliance reports downloaded by `compliance_report_puller.py` (located in the `pdfs/` directory). It uses the `camelot-py` library to extract tabular data from these PDFs, performs data cleaning and consolidation.
    *   **Output:** Generates a single, consolidated CSV file named `SPARCS_Compliance_Report.csv`.

3.  **`src/audit_report_table_extractor.py`**
    *   **Functionality:** Scrapes *HTML tables* from various web pages listing SPARCS audit reports. These are typically found on sub-pages linked from the main SPARCS reports page (e.g., sections within `https://www.health.ny.gov/statistics/sparcs/reports/`).
    *   **Output:** Saves each extracted HTML table as an individual CSV file into the `output/` directory.
    *   **Note:** The name `audit_report_table_extractor.py` might be slightly misleading as it processes HTML tables from web pages, not PDF audit reports directly in the same way the compliance scripts handle PDFs. A name like `audit_html_table_scraper.py` or `sparcs_html_table_extractor.py` could be more descriptive of its specific function.

## Usage Overview

The typical workflow for processing SPARCS *compliance reports* is:

1.  Run `python src/compliance_report_puller.py` to download the PDF reports into the `pdfs/` directory.
2.  Then, run `python src/compliance_table_extractor.py` to process these PDFs and generate the `SPARCS_Compliance_Report.csv`.

The `src/audit_report_table_extractor.py` script can be run independently to scrape HTML table data from the relevant audit report web pages.

## Output Files

The key output files generated by these scripts are:

*   **`SPARCS_Compliance_Report.csv`**: A consolidated CSV containing data extracted from all processed PDF compliance reports.
*   **`pdfs/` (directory)**: Contains the downloaded PDF compliance reports (e.g., `2022_PFI_123456.pdf`).
*   **`output/` (directory)**: Contains individual CSV files, each corresponding to an HTML table scraped by `audit_report_table_extractor.py` (e.g., `audit_data_export_2023.csv`).